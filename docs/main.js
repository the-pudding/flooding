parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"or4r":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3],e="Expected a function",n=NaN,r="[object Symbol]",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,c=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,v=a||s||Function("return this")(),l=Object.prototype,p=l.toString,b=Math.max,m=Math.min,y=function(){return v.Date.now()};function d(t,n,r){var i,o,u,f,c,a,s=0,v=!1,l=!1,p=!0;if("function"!=typeof t)throw new TypeError(e);function d(e){var n=i,r=o;return i=o=void 0,s=e,f=t.apply(r,n)}function g(t){var e=t-a;return void 0===a||e>=n||e<0||l&&t-s>=u}function O(){var t=y();if(g(t))return x(t);c=setTimeout(O,function(t){var e=n-(t-a);return l?m(e,u-(t-s)):e}(t))}function x(t){return c=void 0,p&&i?d(t):(i=o=void 0,f)}function T(){var t=y(),e=g(t);if(i=arguments,o=this,a=t,e){if(void 0===c)return function(t){return s=t,c=setTimeout(O,n),v?d(t):f}(a);if(l)return c=setTimeout(O,n),d(a)}return void 0===c&&(c=setTimeout(O,n)),f}return n=h(n)||0,j(r)&&(v=!!r.leading,u=(l="maxWait"in r)?b(h(r.maxWait)||0,n):u,p="trailing"in r?!!r.trailing:p),T.cancel=function(){void 0!==c&&clearTimeout(c),s=0,i=a=o=c=void 0},T.flush=function(){return void 0===c?f:x(y())},T}function j(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function O(t){return"symbol"==typeof t||g(t)&&p.call(t)==r}function h(t){if("number"==typeof t)return t;if(O(t))return n;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var r=u.test(t);return r||f.test(t)?c(t.slice(2),r?2:8):o.test(t)?n:+t}module.exports=d;
},{}],"WEtf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return r.android()||r.blackberry()||r.ios()||r.opera()||r.windows()}},e=r;exports.default=e;
},{}],"hZBy":[function(require,module,exports) {
"use strict";function e(e){return r(e)||n(e)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function r(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function o(e){return document.querySelector(e)}function s(t){return e((arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelectorAll(t))}function c(t,n){return e(t.querySelectorAll(n))}function a(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)".concat(t.split(" ").join("|"),"(\\b|$)"),"gi")," ")}function l(e,t){e.classList?e.classList.add(t):e.className="".concat(e.className," ").concat(t)}function i(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )".concat(t,"( |$)"),"gi").test(e.className)}function u(e,t){t=t||0;var n=e.getBoundingClientRect().top+t,r=(window.pageYOffset||document.documentElement.scrollTop)+n;window.scrollTo(0,r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.select=o,exports.selectAll=s,exports.find=c,exports.removeClass=a,exports.addClass=l,exports.hasClass=i,exports.jumpTo=u;
},{}],"U9xJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=require("./dom");function t(){(0,e.selectAll)("[target='_blank']").forEach(function(e){return e.setAttribute("rel","noopener")})}
},{"./dom":"hZBy"}],"v9Q8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=[{image:"2018_02_stand-up",url:"2018/02/stand-up",hed:"The Structure of Stand-Up Comedy"},{image:"2018_04_birthday-paradox",url:"2018/04/birthday-paradox",hed:"The Birthday Paradox Experiment"},{image:"2018_11_boy-bands",url:"2018/11/boy-bands",hed:"Internet Boy Band Database"},{image:"2018_08_pockets",url:"2018/08/pockets",hed:"Womenâ€™s Pockets are Inferior"}],t=null;function n(e,t){var n=document.getElementsByTagName("script")[0],o=document.createElement("script");return o.src=e,o.async=!0,n.parentNode.insertBefore(o,n),t&&"function"==typeof t&&(o.onload=t),o}function o(t){var n=new XMLHttpRequest,o=Date.now(),r="https://pudding.cool/assets/data/stories.json?v=".concat(o);n.open("GET",r,!0),n.onload=function(){if(n.status>=200&&n.status<400){var o=JSON.parse(n.responseText);t(o)}else t(e)},n.onerror=function(){return t(e)},n.send()}function r(e){return"\n\t<a class='footer-recirc__article' href='https://pudding.cool/".concat(e.url,"' target='_blank' rel='noopener'>\n\t\t<img class='article__img' src='https://pudding.cool/common/assets/thumbnails/640/").concat(e.image,".jpg' alt='").concat(e.hed,"'>\n\t\t<p class='article__headline'>").concat(e.hed,"</p>\n\t</a>\n\t")}function a(){var e=window.location.href,n=t.filter(function(t){return!e.includes(t.url)}).slice(0,4).map(r).join("");d3.select(".pudding-footer .footer-recirc__articles").html(n)}function s(){o(function(e){t=e,a()})}var c={init:s};exports.default=c;
},{}],"HxQE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=d3.format(",");function e(e,r){var o={type:"FeatureCollection",features:[]};if("cluster"==r)return e=e.map(function(e){return{type:"Feature",properties:{id:"Zipcode: "+e.Zipcode,count2:+e["FS 2050 100 Year Risk (total)"],count:+e["FS 2020 100 Year Risk (total)"],countFormatted:t(+e["FS 2020 100 Year Risk (total)"])},geometry:{type:"Point",coordinates:[e.Longitude,e.Latitude]}}}),o.features=e,o;if("cluster2"==r)return e=e.map(function(e){return{type:"Feature",properties:{id:"Zipcode: "+e.Zipcode,count2:+e["FS 2050 100 Year Risk (total)"],count:+e["FS 2050 100 Year Risk (total)"],countFormatted:t(+e["FS 2050 100 Year Risk (total)"])},geometry:{type:"Point",coordinates:[e.Longitude,e.Latitude]}}}),o.features=e,o;return e=e.map(function(t){return{type:"Feature",properties:{type:"manual",title:t.locationName,state:t.state_iso2},place_type:["search"],geometry:{type:"Point",coordinates:[t.Longitude,t.Latitude]}}}),o.features=e,o}var r={init:e};exports.default=r;
},{}],"YNPR":[function(require,module,exports) {
"use strict";function e(e,t){var a=e.append("div").attr("class","embed-input-wrapper");a.append("p").text("Copy this iframe text into your code"),a.append("textarea").text('<iframe src="'+t+'" width="100%" height="600" style="max-width:600px;"></iframe>')}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t={init:e};exports.default=t;
},{}],"ThHl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("./searchCreate.js")),t=a(require("./createGeojson")),r=a(require("./embed-code"));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(r,!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=d3.format(","),i=[],s="Cleveland",u=null,d=null,p=null,f={city:"",county:" county",state:""};function b(e){d3.select(".table-wrapper").selectAll(".property-table").style("display",null),d3.select(".table-wrapper").select("."+e+"-table").style("display","block")}function y(e,t){u=e.attr("geo-selected"),s=e.attr("data-city"),d=e.attr("data-state"),e.select(".city-selected").text(s);var r=t,a=e.select(".table").selectAll("div").data(r.slice(0,10),function(e,t){return e.locationName+t}),o=a.enter().append("div").attr("class","row");a.exit().remove(),o.classed("selected",function(e,t){return 0==t});o.append("p").text(function(e){return"state"==u?e.locationName:"".concat(e.locationName+f[u],", ").concat(e.state_iso2.toUpperCase())}).attr("class","city-name"),o.append("p").text(function(e){return l(Math.round(e["FS 2020 100 Year Risk (total)"]))}).attr("class","flooded-property-count"),o.append("p").text(function(e){return l(Math.round(e["Total Properties"]))}).attr("class","property-count"),o.append("p").text(function(e){return"".concat(Math.round(e["FS 2020 100 Year Risk (total)"]/e["Total Properties"]*100),"%")}).attr("class","percent")}function m(e,t){var r=t.map(function(t){return n({},t,{distance:calculatingDistance(e.latitude,e.longitude,+t.Latitude,+t.Longitude)})}).filter(function(e){return!isNaN(e.distance)});return r.sort(function(e,t){return d3.descending(t.distance,e.distance)}),r}function g(a,o,n,c){var l=t.default.init(a,"search"),i="";"county"==c&&(i=" county"),mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ";var s=new MapboxGeocoder({accessToken:mapboxgl.accessToken,countries:"us",localGeocoder:function(e){for(var t=[],r=0;r<l.features.length;r++){var a=l.features[r];-1!==a.properties.title.toLowerCase().search(e.toLowerCase())&&(a.place_name=a.properties.title+i+", "+a.properties.state.toUpperCase(),a.center=a.geometry.coordinates,t.push(a))}return t},placeholder:"Find a location",zoom:7,localGeocoderOnly:!0,marker:!1}),d=o.select(".search").node(),f=s.onAdd();d.appendChild(f),s.on("result",function(t){o.attr("data-city",t.result.place_name),o.attr("data-state",t.result.properties.state);var r=t.result.geometry.coordinates[0],n=+t.result.geometry.coordinates[1];p.Latitude=n,p.Longitude=r;var c=e.default.findNearest({latitude:n,longitude:r},a);y(o,c)}),u=c,o.attr("geo-selected",u),o.attr("type-selected","table"),p=n[u][0],o.attr("data-city",p.locationName),o.attr("data-state",p.state_iso2),y(o,n[c]);var b=!1;o.select(".embed-button").on("click",function(e){var t=+p.Latitude,a=+p.Longitude;console.log(p),b||(r.default.init(d3.select(this.parentNode),"https://pudding.cool/projects/flooding/visuals/embed.html?embed=true&chart=property-table-embed&lat="+t+"&lon="+a),b=!0)})}var v={init:g,buildTable:y,tableButtonClick:b};exports.default=v;
},{"./searchCreate.js":"pniV","./createGeojson":"HxQE","./embed-code":"YNPR"}],"pniV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./propertyTable.js"));function e(t){return t&&t.__esModule?t:{default:t}}function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function r(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(r,!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o={city:"",county:" county",state:""};function c(t,e,n,r){function a(t){return t*Math.PI/180}var o=a(t),c=a(n),i=a(n-t),u=a(r-e),s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o)*Math.cos(c)*Math.sin(u/2)*Math.sin(u/2);return 3958.756*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function i(t,e){var n=e.map(function(e){return r({},e,{distance:c(t.latitude,t.longitude,+e.Latitude,+e.Longitude)})}).filter(function(t){return!isNaN(t.distance)});return n.sort(function(t,e){return d3.descending(e.distance,t.distance)}),n}function u(e,n,r,a){e.select(".results-wrapper").style("display","block");var c=r.attr("geo-selected"),u=e.select(".results-wrapper").selectAll("p").data(n,function(t){return t.locationName});u.enter().append("p").text(function(t){return"state"==c?t.locationName+o[c]:"".concat(t.locationName+o[c],", ").concat(t.state_iso2.toUpperCase())}).on("click",function(n){console.log("clicked");var o=r.attr("type-selected");e.select("input").node().value="",r.attr("data-city",n.locationName),r.attr("data-state",n.state_iso2);var c=i({latitude:+n.Latitude,longitude:+n.Longitude},a);r.select(".results-wrapper").style("display",null),"table"==o&&t.default.buildTable(r,c)}),u.exit().remove()}function s(t){return t.replace(/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,"\\$&")}function l(t,e){var n=new RegExp("\\b".concat(s(e)),"i");return t.filter(function(t){return n.test(t.locationName)}).slice(0,10)}function p(t,e,n){var r=t.select(".search"),a=null;r.select("input").on("keyup",function(){this.value.trim().length>2&&(a=l(e,this.value.trim())).length>0?u(r,a,t,e):t.select(".results-wrapper").style("display",null)}),console.log(r.node()),r.node().addEventListener("focusout",function(e){console.log("focusing out");var n=d3.timer(function(e){e>200&&(n.stop(),t.select(".results-wrapper").style("display",null))},500)})}var d={setupSearchBox:p,findNearest:i};exports.default=d;
},{"./propertyTable.js":"ThHl"}],"PndQ":[function(require,module,exports) {
function t(t){if(t)return e(t)}function e(e){for(var s in t.prototype)e[s]=t.prototype[s];return e}"undefined"!=typeof module&&(module.exports=t),t.prototype.on=t.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},t.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((s=r[i])===e||s.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},t.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(s){r=0;for(var i=(s=s.slice(0)).length;r<i;++r)s[r].apply(this,e)}return this},t.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},t.prototype.hasListeners=function(t){return!!this.listeners(t).length};
},{}],"L4M6":[function(require,module,exports) {
module.exports=t,t.default=t,t.stable=o,t.stableStringify=o;var r=[],e=[];function t(t,i,o){var f;for(n(t,"",[],void 0),f=0===e.length?JSON.stringify(t,i,o):JSON.stringify(t,u(i),o);0!==r.length;){var l=r.pop();4===l.length?Object.defineProperty(l[0],l[1],l[3]):l[0][l[1]]=l[2]}return f}function n(t,i,o,f){var u;if("object"==typeof t&&null!==t){for(u=0;u<o.length;u++)if(o[u]===t){var l=Object.getOwnPropertyDescriptor(f,i);return void(void 0!==l.get?l.configurable?(Object.defineProperty(f,i,{value:"[Circular]"}),r.push([f,i,t,l])):e.push([t,i]):(f[i]="[Circular]",r.push([f,i,t])))}if(o.push(t),Array.isArray(t))for(u=0;u<t.length;u++)n(t[u],u,o,t);else{var a=Object.keys(t);for(u=0;u<a.length;u++){var c=a[u];n(t[c],c,o,t)}}o.pop()}}function i(r,e){return r<e?-1:r>e?1:0}function o(t,n,i){var o,l=f(t,"",[],void 0)||t;for(o=0===e.length?JSON.stringify(l,n,i):JSON.stringify(l,u(n),i);0!==r.length;){var a=r.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}return o}function f(t,n,o,u){var l;if("object"==typeof t&&null!==t){for(l=0;l<o.length;l++)if(o[l]===t){var a=Object.getOwnPropertyDescriptor(u,n);return void(void 0!==a.get?a.configurable?(Object.defineProperty(u,n,{value:"[Circular]"}),r.push([u,n,t,a])):e.push([t,n]):(u[n]="[Circular]",r.push([u,n,t])))}if("function"==typeof t.toJSON)return;if(o.push(t),Array.isArray(t))for(l=0;l<t.length;l++)f(t[l],l,o,t);else{var c={},p=Object.keys(t).sort(i);for(l=0;l<p.length;l++){var s=p[l];f(t[s],s,o,t),c[s]=t[s]}if(void 0===u)return c;r.push([u,n,t]),u[n]=c}o.pop()}}function u(r){return r=void 0!==r?r:function(r,e){return e},function(t,n){if(e.length>0)for(var i=0;i<e.length;i++){var o=e[i];if(o[1]===t&&o[0]===n){n="[Circular]",e.splice(i,1);break}}return r.call(this,t,n)}}
},{}],"ymYf":[function(require,module,exports) {
"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(t)}function t(t){return null!==t&&"object"===o(t)}module.exports=t;
},{}],"zs9O":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}var e=require("./is-object");function r(t){if(t)return i(t)}function i(t){for(var e in r.prototype)Object.prototype.hasOwnProperty.call(r.prototype,e)&&(t[e]=r.prototype[e]);return t}module.exports=r,r.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},r.prototype.parse=function(t){return this._parser=t,this},r.prototype.responseType=function(t){return this._responseType=t,this},r.prototype.serialize=function(t){return this._serializer=t,this},r.prototype.timeout=function(e){if(!e||"object"!==t(e))return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))switch(r){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;case"upload":this._uploadTimeout=e.upload;break;default:console.warn("Unknown timeout option",r)}return this},r.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];r.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(t,e);if(!0===r)return!0;if(!1===r)return!1}catch(i){console.error(i)}if(e&&e.status&&e.status>=500&&501!==e.status)return!0;if(t){if(t.code&&o.includes(t.code))return!0;if(t.timeout&&"ECONNABORTED"===t.code)return!0;if(t.crossDomain)return!0}return!1},r.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},r.prototype.then=function(t,e){var r=this;if(!this._fullfilledPromise){var i=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(t,e){i.on("abort",function(){if(r.timedout&&r.timedoutError)e(r.timedoutError);else{var t=new Error("Aborted");t.code="ABORTED",t.status=r.status,t.method=r.method,t.url=r.url,e(t)}}),i.end(function(r,i){r?e(r):t(i)})})}return this._fullfilledPromise.then(t,e)},r.prototype.catch=function(t){return this.then(void 0,t)},r.prototype.use=function(t){return t(this),this},r.prototype.ok=function(t){if("function"!=typeof t)throw new Error("Callback required");return this._okCallback=t,this},r.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},r.prototype.get=function(t){return this._header[t.toLowerCase()]},r.prototype.getHeader=r.prototype.get,r.prototype.set=function(t,r){if(e(t)){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&this.set(i,t[i]);return this}return this._header[t.toLowerCase()]=r,this.header[t]=r,this},r.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},r.prototype.field=function(t,r){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(e(t)){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&this.field(i,t[i]);return this}if(Array.isArray(r)){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&this.field(t,r[o]);return this}if(null==r)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof r&&(r=String(r)),this._getFormData().append(t,r),this},r.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},r.prototype._auth=function(t,e,r,i){switch(r.type){case"basic":this.set("Authorization","Basic ".concat(i("".concat(t,":").concat(e))));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer ".concat(t))}return this},r.prototype.withCredentials=function(t){return void 0===t&&(t=!0),this._withCredentials=t,this},r.prototype.redirects=function(t){return this._maxRedirects=t,this},r.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw new TypeError("Invalid argument");return this._maxResponseSize=t,this},r.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},r.prototype.send=function(t){var r=e(t),i=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(r&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(r&&e(this._data))for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this._data[o]=t[o]);else"string"==typeof t?(i||this.type("form"),i=this._header["content-type"],this._data="application/x-www-form-urlencoded"===i?this._data?"".concat(this._data,"&").concat(t):t:(this._data||"")+t):this._data=t;return!r||this._isHost(t)?this:(i||this.type("json"),this)},r.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},r.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.includes("?")?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.slice(e+1).split("&");"function"==typeof this._sort?r.sort(this._sort):r.sort(),this.url=this.url.slice(0,e)+"?"+r.join("&")}}},r.prototype._appendQueryString=function(){console.warn("Unsupported")},r.prototype._timeoutError=function(t,e,r){if(!this._aborted){var i=new Error("".concat(t+e,"ms exceeded"));i.timeout=e,i.code="ECONNABORTED",i.errno=r,this.timedout=!0,this.timedoutError=i,this.abort(),this.callback(i)}},r.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};
},{"./is-object":"ymYf"}],"wfik":[function(require,module,exports) {
"use strict";exports.type=function(e){return e.split(/ *; */).shift()},exports.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})},exports.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */),r=n[0].slice(1,-1);return e[n[1].split(/ *= */)[1].slice(1,-1)]=r,e},{})},exports.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e};
},{}],"afOI":[function(require,module,exports) {
"use strict";var t=require("./utils");function e(t){if(t)return r(t)}function r(t){for(var r in e.prototype)Object.prototype.hasOwnProperty.call(e.prototype,r)&&(t[r]=e.prototype[r]);return t}module.exports=e,e.prototype.get=function(t){return this.header[t.toLowerCase()]},e.prototype._setHeaderProperties=function(e){var r=e["content-type"]||"";this.type=t.type(r);var s=t.params(r);for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(this[i]=s[i]);this.links={};try{e.link&&(this.links=t.parseLinks(e.link))}catch(o){}},e.prototype._setStatusProperties=function(t){var e=t/100|0;this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=1===e,this.ok=2===e,this.redirect=3===e,this.clientError=4===e,this.serverError=5===e,this.error=(4===e||5===e)&&this.toError(),this.created=201===t,this.accepted=202===t,this.noContent=204===t,this.badRequest=400===t,this.unauthorized=401===t,this.notAcceptable=406===t,this.forbidden=403===t,this.notFound=404===t,this.unprocessableEntity=422===t};
},{"./utils":"wfik"}],"zbFA":[function(require,module,exports) {
"use strict";function t(t){return n(t)||e(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function n(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}function o(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"].forEach(function(t){o.prototype[t]=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return this._defaults.push({fn:t,args:e}),this}}),o.prototype._setDefaults=function(r){this._defaults.forEach(function(e){r[e.fn].apply(r,t(e.args))})},module.exports=o;
},{}],"CC3B":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}var e;"undefined"!=typeof window?e=window:"undefined"==typeof self?(console.warn("Using browser-only version of superagent in non-browser environment"),e=void 0):e=self;var r=require("component-emitter"),o=require("fast-safe-stringify"),n=require("./request-base"),s=require("./is-object"),i=require("./response-base"),a=require("./agent-base");function u(){}module.exports=function(t,e){return"function"==typeof e?new exports.Request("GET",t).end(e):1===arguments.length?new exports.Request("GET",t):new exports.Request(t,e)},exports=module.exports;var p=exports;exports.Request=w,p.getXHR=function(){if(e.XMLHttpRequest&&(!e.location||"file:"!==e.location.protocol||!e.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(r){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(o){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(n){}throw new Error("Browser-only version of superagent could not find XHR")};var c="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function h(t){if(!s(t))return t;var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&l(e,r,t[r]);return e.join("&")}function l(t,e,r){if(void 0!==r)if(null!==r)if(Array.isArray(r))r.forEach(function(r){l(t,e,r)});else if(s(r))for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&l(t,"".concat(e,"[").concat(o,"]"),r[o]);else t.push(encodeURI(e)+"="+encodeURIComponent(r));else t.push(encodeURI(e))}function d(t){for(var e,r,o={},n=t.split("&"),s=0,i=n.length;s<i;++s)-1===(r=(e=n[s]).indexOf("="))?o[decodeURIComponent(e)]="":o[decodeURIComponent(e.slice(0,r))]=decodeURIComponent(e.slice(r+1));return o}function f(t){for(var e,r,o,n,s=t.split(/\r?\n/),i={},a=0,u=s.length;a<u;++a)-1!==(e=(r=s[a]).indexOf(":"))&&(o=r.slice(0,e).toLowerCase(),n=c(r.slice(e+1)),i[o]=n);return i}function y(t){return/[\/+]json($|[^-\w])/.test(t)}function m(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.headers=f(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType?this.body=this.xhr.response:this.body="HEAD"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function w(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t,e=null,o=null;try{o=new m(r)}catch(n){return(e=new Error("Parser is unable to parse the response")).parse=!0,e.original=n,r.xhr?(e.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,e.status=r.xhr.status?r.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),r.callback(e)}r.emit("response",o);try{r._isResponseOK(o)||(t=new Error(o.statusText||o.text||"Unsuccessful HTTP response"))}catch(n){t=n}t?(t.original=e,t.response=o,t.status=o.status,r.callback(t,o)):r.callback(null,o)})}function T(t,e,r){var o=p("DELETE",t);return"function"==typeof e&&(r=e,e=null),e&&o.send(e),r&&o.end(r),o}p.serializeObject=h,p.parseString=d,p.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},p.serialize={"application/x-www-form-urlencoded":h,"application/json":o},p.parse={"application/x-www-form-urlencoded":d,"application/json":JSON.parse},i(m.prototype),m.prototype._parseBody=function(t){var e=p.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&y(this.type)&&(e=p.parse["application/json"]),e&&t&&(t.length>0||t instanceof Object)?e(t):null)},m.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,o="cannot ".concat(e," ").concat(r," (").concat(this.status,")"),n=new Error(o);return n.status=this.status,n.method=e,n.url=r,n},p.Response=m,r(w.prototype),n(w.prototype),w.prototype.type=function(t){return this.set("Content-Type",p.types[t]||t),this},w.prototype.accept=function(t){return this.set("Accept",p.types[t]||t),this},w.prototype.auth=function(e,r,o){1===arguments.length&&(r=""),"object"===t(r)&&null!==r&&(o=r,r=""),o||(o={type:"function"==typeof btoa?"basic":"auto"});return this._auth(e,r,o,function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")})},w.prototype.query=function(t){return"string"!=typeof t&&(t=h(t)),t&&this._query.push(t),this},w.prototype.attach=function(t,e,r){if(e){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,r||e.name)}return this},w.prototype._getFormData=function(){return this._formData||(this._formData=new e.FormData),this._formData},w.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var r=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),r(t,e)},w.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},w.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},w.prototype.ca=w.prototype.agent,w.prototype.buffer=w.prototype.ca,w.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},w.prototype.pipe=w.prototype.write,w.prototype._isHost=function(e){return e&&"object"===t(e)&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},w.prototype.end=function(t){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||u,this._finalizeQueryString(),this._end()},w.prototype._setUploadTimeout=function(){var t=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(function(){t._timeoutError("Upload timeout of ",t._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},w.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var t=this;this.xhr=p.getXHR();var e=this.xhr,r=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var r=e.readyState;if(r>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4===r){var o;try{o=e.status}catch(n){o=0}if(!o){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var o=function(e,r){r.total>0&&(r.percent=r.loaded/r.total*100,100===r.percent&&clearTimeout(t._uploadTimeoutTimer)),r.direction=e,t.emit("progress",r)};if(this.hasListeners("progress"))try{e.addEventListener("progress",o.bind(null,"download")),e.upload&&e.upload.addEventListener("progress",o.bind(null,"upload"))}catch(a){}e.upload&&this._setUploadTimeout();try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(u){return this.callback(u)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!==this.method&&"HEAD"!==this.method&&"string"!=typeof r&&!this._isHost(r)){var n=this._header["content-type"],s=this._serializer||p.serialize[n?n.split(";")[0]:""];!s&&y(n)&&(s=p.serialize["application/json"]),s&&(r=s(r))}for(var i in this.header)null!==this.header[i]&&Object.prototype.hasOwnProperty.call(this.header,i)&&e.setRequestHeader(i,this.header[i]);this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0===r?null:r)},p.agent=function(){return new a},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(t){a.prototype[t.toLowerCase()]=function(e,r){var o=new p.Request(t,e);return this._setDefaults(o),r&&o.end(r),o}}),a.prototype.del=a.prototype.delete,p.get=function(t,e,r){var o=p("GET",t);return"function"==typeof e&&(r=e,e=null),e&&o.query(e),r&&o.end(r),o},p.head=function(t,e,r){var o=p("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&o.query(e),r&&o.end(r),o},p.options=function(t,e,r){var o=p("OPTIONS",t);return"function"==typeof e&&(r=e,e=null),e&&o.send(e),r&&o.end(r),o},p.del=T,p.delete=T,p.patch=function(t,e,r){var o=p("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&o.send(e),r&&o.end(r),o},p.post=function(t,e,r){var o=p("POST",t);return"function"==typeof e&&(r=e,e=null),e&&o.send(e),r&&o.end(r),o},p.put=function(t,e,r){var o=p("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&o.send(e),r&&o.end(r),o};
},{"component-emitter":"PndQ","fast-safe-stringify":"L4M6","./request-base":"zs9O","./is-object":"ymYf","./response-base":"afOI","./agent-base":"zbFA"}],"HZvp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={ip:"72.228.10.129",hostname:"cpe-72-228-10-129.nycap.res.rr.com",type:"ipv4",continent_code:"NA",continent_name:"North America",country_code:"US",country_name:"United States",region_code:"MA",region_name:"Massachusetts",city:"Great Barrington",zip:"01230",latitude:42.1617,longitude:-73.3277,location:{geoname_id:4938157,capital:"Washington D.C.",languages:[{code:"en",name:"English",native:"English"}],country_flag:"http://assets.ipstack.com/flags/us.svg",country_flag_emoji:"ðŸ‡ºðŸ‡¸",country_flag_emoji_unicode:"U+1F1FA U+1F1F8",calling_code:"1",is_eu:!1},time_zone:{id:"America/New_York",current_time:"2018-04-17T15:29:13-04:00",gmt_offset:-14400,code:"EDT",is_daylight_saving:!0},currency:{code:"USD",name:"US Dollar",plural:"US dollars",symbol:"$",symbol_native:"$"},connection:{asn:11351,isp:"Time Warner Cable Internet LLC"},security:{is_proxy:!1,proxy_type:null,is_crawler:!1,crawler_name:null,crawler_type:null,is_tor:!1,threat_level:"low",threat_types:null}};exports.default=e;
},{}],"NSOq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("superagent")),t=r(require("./locate-test"));function r(e){return e&&e.__esModule?e:{default:e}}var n=!1,u=4e3,s=null;function o(){if(n)return Promise.resolve(t.default);return new Promise(function(t,r){e.default.get("https://api.ipify.org?format=json").end(function(e,n){e?r(e):n&&n.status>=200&&n.status<400?t(JSON.parse(n.text)):r(e)})})}function i(r){var u=r.ip;if(n)return Promise.resolve(t.default);var o="https://api.ipstack.com/".concat(u,"?access_key=").concat(s);return new Promise(function(t,r){e.default.get(o).end(function(e,n){if(e)r(e);else if(n&&n.status>=200&&n.status<400){var u=JSON.parse(n.text);u.error?r(u.error):t(u)}else r(e)})})}function a(e,t){if(e){s=e;var r=setTimeout(function(){return t("timeout")},u);o().then(i).then(function(e){clearTimeout(r),t(null,e)}).catch(function(e){return t(e)})}else t("error: must pass ipstack key")}var c=a;exports.default=c;
},{"superagent":"CC3B","./locate-test":"HZvp"}],"qaWx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("./searchCreate.js")),t=i(require("./createGeojson")),o=i(require("./embed-code")),a=i(require("./utils/locate"));function i(e){return e&&e.__esModule?e:{default:e}}function l(){}function r(e){map.setLayoutProperty(e,"text-field",["format",["get","name_clean"],{"font-scale":1},"\n",{},["get","place"],{"font-scale":.75,"text-font":["literal",["Roboto Mono Regular","Rubik Black"]]}])}function n(e,a){a.cityData.concat(a.countyData).concat(a.stateData);var i=t.default.init(a.zipData,"cluster"),l=t.default.init(a.zipData,"cluster2");var r,n=t.default.init(a.countyData,"search");r=[e.state[0].Longitude,e.state[0].Latitude],mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2thZWxrN3cxMDVpYTJ0bXZwenI2ZXl1ZCJ9.E0ICxBW96VVQbnQqyRTWbA";var c=new mapboxgl.Map({container:"city-cluster",style:"mapbox://styles/mapbox/light-v10",center:r,minZoom:4,clusterMaxZoom:10,zoom:4}),s=new MapboxGeocoder({accessToken:mapboxgl.accessToken,countries:"us",localGeocoder:function(e){for(var t=[],o=0;o<n.features.length;o++){var a=n.features[o];-1!==a.properties.title.toLowerCase().search(e.toLowerCase())&&(a.place_name=a.properties.title+" county, "+a.properties.state.toUpperCase(),a.center=a.geometry.coordinates,t.push(a))}return t},placeholder:"Find a location",filter:function(e){return"poi"!=e.place_type[0]},zoom:7,marker:!1,mapboxgl:mapboxgl});document.getElementById("geocode").appendChild(s.onAdd(c));var p=!1,d=null;d3.select("#city-cluster").each(function(e){d=d3.select(this.parentNode)}),d.select(".embed-button").on("click",function(e){var t=c.getCenter();p||(o.default.init(d3.select(this.parentNode),"https://pudding.cool/projects/flooding/visuals/embed.html?embed=true&chart=cluster-map&lat="+t.lat+"&lon="+t.lng),p=!0)}),c.on("load",function(){c.addSource("postal-2",{type:"vector",url:"mapbox://mapbox.boundaries-pos4-v3"}),c.addLayer({id:"postal-2-fill",type:"fill",source:"postal-2","source-layer":"boundaries_postal_4",paint:{"fill-outline-color":"rgba(0,0,0,0)","fill-opacity":.1,"fill-color":"#000"},minzoom:7,maxzoom:10},"admin-1-boundary"),c.addLayer({id:"postal-2-line",type:"line",source:"postal-2","source-layer":"boundaries_postal_4",minzoom:7,paint:{"line-width":1,"line-opacity":.8,"line-color":"#aaa"}}),c.addSource("points",{type:"geojson",data:i,cluster:!0,clusterRadius:30,clusterProperties:{pointTotal:["+",["get","count"]]}}),c.addLayer({id:"unclustered-point",type:"circle",source:"points",filter:["!",["has","point_count"]],paint:{"circle-opacity":.5,"circle-color":"#000","circle-radius":["interpolate",["linear"],["zoom"],4,["interpolate",["linear"],["get","count"],1e4,5,2e5,30],9,["interpolate",["linear"],["get","count"],500,5,1e4,30]]}}),c.addLayer({id:"unclustered-label",type:"symbol",source:"points",filter:["!",["has","point_count"]],paint:{"text-halo-width":1,"text-halo-color":"#FFFFFF"},layout:{"text-field":["format",["get","countFormatted"],{"font-scale":1.1,"text-font":["literal",["Open Sans Bold","Arial Unicode MS Bold"]]},"\n",{},["get","id"],{"font-scale":.85,"text-font":["literal",["Open Sans Semibold","Arial Unicode MS Bold"]]}],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":10}}),c.addLayer({id:"clusters",type:"circle",source:"points",filter:["has","point_count"],paint:{"circle-opacity":.8,"circle-color":["step",["get","pointTotal"],"#51bbd6",1e3,"#f1f075",1e4,"#f28cb1"],"circle-radius":["interpolate",["linear"],["zoom"],4,["interpolate",["linear"],["get","pointTotal"],1e4,5,2e5,30],9,["interpolate",["linear"],["get","pointTotal"],500,5,1e4,30]]}}),c.addLayer({id:"earthquake_label",type:"symbol",source:"points",filter:["has","point_count"],layout:{"text-field":["number-format",["get","pointTotal"],{"min-fraction-digits":0,"max-fraction-digits":0}],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":10}}),c.addSource("fsf",{type:"raster",tiles:["https://api.firststreet.org/v1/tile/probability/depth/2020/100/{z}/{x}/{y}.png?key=w6e9nl3apphi9ln2mux4aazyd9gics5a"],tileSize:256}),c.addLayer({id:"fsf",source:"fsf",type:"raster",minzoom:10,maxzoom:18,paint:{"raster-opacity":.8}},"postal-2-fill"),c.on("mousemove",function(e){var t=c.queryRenderedFeatures(e.point,{layers:["unclustered-point"]});t.length>0&&console.log(t[0])});var e=2020;d3.select("#city-cluster").select(".controls-container").selectAll("input").on("change",function(t){var o=+d3.select(this).attr("value");o!=e&&(e=o,d3.select(".year-selected-map").text(e),2020==e?c.getSource("points").setData(i):c.getSource("points").setData(l))}),d3.select(".click-to-explore").on("click",function(){})})}var c={init:n,resize:l};exports.default=c;
},{"./searchCreate.js":"pniV","./createGeojson":"HxQE","./embed-code":"YNPR","./utils/locate":"NSOq"}],"xZJw":[function(require,module,exports) {
"use strict";function t(t){return new Promise(function(e,n){var r=t.split(".").pop();"csv"===r?d3.csv("assets/data/".concat(t)).then(e).catch(n):"json"===r?d3.json("assets/data/".concat(t)).then(e).catch(n):n(new Error("unsupported file type for: ".concat(t)))})}function e(e){if("string"==typeof e)return t(e);var n=e.map(t);return Promise.all(n)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"b8Pa":[function(require,module,exports) {
"use strict";function e(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function t(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?e(a,!0).forEach(function(e){o(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function o(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n={city:"",county:" county",state:"",zipcode:"zipcode"},a={county:"countyData",zipcode:"zipData"};function i(e){return"climate"==e?[1,1.15]:"fema"==e?[1,8]:void 0}function r(e){return d3.map(e,function(e){return+e.index})}function l(e,o){var n=o.map(function(o){return t({},o,{distance:c(e.latitude,e.longitude,+o.Latitude,+o.Longitude)})}).filter(function(e){return!isNaN(e.distance)});return n.sort(function(e,t){return d3.descending(t.distance,e.distance)}),n}function c(e,t,o,n){function a(e){return e*Math.PI/180}var i=a(e),r=a(o),l=a(o-e),c=a(n-t),s=Math.sin(l/2)*Math.sin(l/2)+Math.cos(i)*Math.cos(r)*Math.sin(c/2)*Math.sin(c/2);return 3958.756*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function s(e,t){var o=e.select(".legend-wrapper");o.append("p").attr("class","legend-text").text("No Change or Decrease"),o.append("div").attr("class","legend-item"),o.append("p").attr("class","legend-text").text("0%");var n=e.select(".legend-wrapper").append("div").attr("class","legend-colors");o.append("p").attr("class","legend-text").text("+"+Math.round(100*(i(t)[1]-1))+"%"),n.selectAll("div").data([.1,.3,.6,.9,1]).enter().append("div").attr("class","legend-item").style("background",function(e){return d3.interpolateRdPu(e)})}function u(e,t){e.select(".map").select(".map-tooltip").style("display",t)}function p(e,t,o,n,a){var i=["match",["id"]],r=[];for(var l in o){var c=+o[l].index,s=f(+o[l][e],+o[l][t],n);s||(s=a.domain()[1]);var u=y(+s,a);c>0&&(i.push(c,u),r.push(c))}return i.push("#f1f1f0"),i}function d(e,t){e.select(".map").append("div").attr("class","map-tooltip")}function y(e,t){return e<1?"#aaa":d3.interpolateRdPu(t(e))}function f(e,t,o){return"climate"==o.scope?t/e:"fema"==o.scope?0==e?null:t/e:void 0}function b(e,t,o,c,y,b,v){var m={locationInput:e,data:t,container:o,geo:c,scope:y,variableOne:b,variableTwo:v},h=!1,g=null,x=null,L=null,O=t[a[L=c]];x=r(O),o.select(".controls-container").selectAll("input").on("change",function(e){if(h||"county"!=d3.select(this).attr("value"))"county"==d3.select(this).attr("value")?(O=t[a.county],x=r(O),L="county",P.setLayoutProperty("postal-fill","visibility","none"),P.setLayoutProperty("postal-line","visibility","none"),P.setLayoutProperty("county-fill","visibility","visible"),P.setLayoutProperty("county-line","visibility","visible")):"zipcode"==d3.select(this).attr("value")&&(O=t[a.zipcode],x=r(O),L="zipcode",P.setLayoutProperty("postal-fill","visibility","visible"),P.setLayoutProperty("postal-line","visibility","visible"),P.setLayoutProperty("county-fill","visibility","none"),P.setLayoutProperty("county-line","visibility","none"));else{var o=function(e){O.forEach(function(e){P.setFeatureState({source:"county",sourceLayer:"boundaries_admin_2",id:+e.index},{hover:!1})})};h=!0,L="county",M="mapbox://mapbox.boundaries-adm2-v3",_="boundaries_admin_2",P.setLayoutProperty("postal-fill","visibility","none"),P.setLayoutProperty("postal-line","visibility","none"),O=t[a.county],x=r(O),w=p(b,v,O,m,g),P.addSource("county",{type:"vector",url:M}),P.addLayer({id:"county-fill",type:"fill",source:"county","source-layer":_,paint:{"fill-outline-color":"rgba(0,0,0,0)","fill-opacity":1,"fill-color":w}},"admin-1-boundary"),P.addLayer({id:"county-line",type:"line",source:"county","source-layer":_,paint:{"line-width":2,"line-opacity":["case",["boolean",["feature-state","hover"],!1],1,0],"line-color":"black"}}),P.isSourceLoaded("county")?o():P.on("sourcedata",function e(t){"county"===t.sourceId&&t.isSourceLoaded&&(o(),P.off("sourcedata",e))})}}),mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ",s(o,y),l(e,O);var P=new mapboxgl.Map({container:o.select(".map").node(),style:"mapbox://styles/mapbox/light-v10",center:[-98.585522,39.8333333],minZoom:"zipcode"==L?3:1,zoom:"zipcode"==L?3:2.5});d(o,P);var j=i(y);d3.map(O,function(e){return+e.index}),d3.extent(O,function(e){return f(+e[b],+e[v],m)});g=d3.scaleLinear().domain(j).range([.1,1]).clamp(!0);var w=p(b,v,O,m,g),M="mapbox://mapbox.boundaries-pos4-v3",_="boundaries_postal_4";"county"==L&&(M="mapbox://mapbox.boundaries-adm2-v3",_="boundaries_admin_2"),P.on("load",function(){function e(e){O.forEach(function(e){P.setFeatureState({source:"postal",sourceLayer:_,id:+e.index},{hover:!1})})}P.addSource("postal",{type:"vector",url:M}),P.addLayer({id:"postal-fill",type:"fill",source:"postal","source-layer":_,paint:{"fill-outline-color":"rgba(0,0,0,0)","fill-opacity":1,"fill-color":w}},"admin-1-boundary"),P.addLayer({id:"postal-line",type:"line",source:"postal","source-layer":_,paint:{"line-width":2,"line-opacity":["case",["boolean",["feature-state","hover"],!1],1,0],"line-color":"black"}}),P.isSourceLoaded("postal")?e():P.on("sourcedata",function t(o){"postal"===o.sourceId&&o.isSourceLoaded&&(e(),P.off("sourcedata",t))});var t=null;P.on("mousemove",function(e){var a="county"==L?["county","county-fill","boundaries_admin_2"]:["postal","postal-fill","boundaries_postal_4"],i=P.queryRenderedFeatures(e.point,{layers:[a[1]]});if(i.length>0)if(Object.keys(i[0]).indexOf("id")>-1){var r=i[0].id;if(x.has(+r)){if(t!=r){var l=x.get(+r);!function(e,t,o,a){var i=e.select(".map").select(".map-tooltip");i.style("left",o.x+"px").style("top",o.y+"px");var r=Math.round(1e3*(f(+t[a.variableOne],+t[a.variableTwo],a)-1))/10+"% increase in properties affected by flooding";f(+t[a.variableOne],+t[a.variableTwo],a)||"fema"!=a.scope||(r="Zero properties identified by FEMA; "+t[a.variableTwo]+" propreties identified by First Street"),Object.keys(t).indexOf("Zipcode")>-1?i.html("<p>"+t.Zipcode+" "+n[L]+"</p><p>"+r+"</p>"):i.html("<p>"+t.locationName+" "+n[L]+"</p><p>"+r+"</p>")}(o,l,e.point,m),u(o,"block"),t&&P.setFeatureState({source:a[0],sourceLayer:a[2],id:t},{hover:!1}),t=r,P.setFeatureState({source:a[0],sourceLayer:a[2],id:r},{hover:!0})}}else u(o,"none")}else u(o,"none");else u(o,"none")}).on("mouseout",function(e){P.setFeatureState({source:"postal",sourceLayer:_,id:t},{hover:!1}),u(o,"none")})})}var v={init:b};exports.default=v;
},{}],"OhWS":[function(require,module,exports) {
"use strict";function t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function e(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(i,!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e,r,n){function i(t){return t*Math.PI/180}var c=i(t),o=i(r),a=i(r-t),u=i(n-e),s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(c)*Math.cos(o)*Math.sin(u/2)*Math.sin(u/2);return 3958.756*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function i(t,r){var i=r.map(function(r){return e({},r,{distance:n(t.latitude,t.longitude,+r.Latitude,+r.Longitude)})}).filter(function(t){return!isNaN(t.distance)});return i.sort(function(t,e){return d3.descending(e.distance,t.distance)}),i.slice(0,10)}function c(t,e){return new Promise(function(r,n){var c=[];["city","state","county","zip"].forEach(function(r){var n="".concat(r,"Data"),o=e[n],a=i(t,o);c[r]=a}),r(c)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=c;
},{}],"RVwr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./embed-code"));function t(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=[],c=[],i=!1,s="county",u=d3.select("[data-js='bars']"),l=u.select("[data-js='bar__figure-single']"),p=l.select("[data-js='bar__container-single']"),d=l.select(".figure__desc"),f=u.selectAll("input"),b=u.select("[data-js='search__bar-single'"),y=d3.scaleLinear(),v=0,g=0,m=[{propertyName:"FEMA Properties at Risk 2020 (total)",text:"...according to <span>FEMA</span>",key:"FEMA"},{propertyName:"FS 2020 100 Year Risk (total)",text:"...according to <span>new</span> estimates in 2020",key:"thisYear"},{propertyName:"FS 2035 100 Year Risk (total)",text:"in 2035",key:"fifteenYears"},{propertyName:"FS 2050 100 Year Risk (total)",text:"in 2050",key:"thirtyYears"}];function j(){var e=p.node().offsetWidth-g-v;y.domain([0,100]).range([0,e-g]).nice(),h()}function O(e){var t=p.selectAll(".g-bar").data(e,function(){return s}).join(function(e){var t=e.append("div").attr("class","g-bar");return t.append("div").attr("class","bar-container"),t.append("p").attr("class","bar-desc").html(function(e){return e.text}),t}).selectAll(".bar-container");t.selectAll(".bar-percent").data(function(e){return[e]},function(){return s}).join(function(e){return e.append("div").attr("class","bar bar-percent")}).style("width",function(e){return"".concat(y(100-e.value),"px")}),t.selectAll(".bar-data").data(function(e){return[e]},function(){return s}).join(function(e){var t=e.append("div").attr("class",function(e){return"bar bar-data bar-".concat(e.key)});return t.append("p"),t}).style("width",function(e){return"".concat(y(e.value),"px")}).select("p").text(function(e){return"".concat(e.value,"%")})}function h(){var e=o[s][0];O(m.map(function(t){return n({},t,{value:+Math.round(e[t.propertyName]/e["Total Properties"]*100)})})),d.select(".reader").text("county"===s?"".concat(e.locationName," County"):e.locationName)}function k(e){s=e.attr("id"),h()}function x(){j()}function P(t,r){o=r,c=t,d3.select(".bar-wrapper").select(".embed-button").on("click",function(t){var r=+o.zip[0].Latitude,n=+o.zip[0].Longitude;i||(e.default.init(d3.select(this.parentNode),"https://pudding.cool/projects/flooding/visuals/embed.html?embed=true&chart=fema-table&lat="+r+"&lon="+n),i=!0)}),x()}var _={init:P,resize:j,singleButtonClick:k};exports.default=_;
},{"./embed-code":"YNPR"}],"Ch10":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=[],n=[],e="county",a=d3.select("[data-js='bars']"),r=a.select("[data-js='bar__figure-multi']"),c=r.select("[data-js='bar__container-multi']"),i=r.select(".figure__desc"),o=d3.scaleLinear(),u=0,s=32,l=d3.format(",.0f");function d(){var t=c.node().offsetWidth-s-u;o.domain([0,100]).range([0,(t-s)/3]).nice()}function f(t){var n=c.selectAll(".g-bar").data(t,function(t){return t.name}).join(function(t){var n=t.append("div").attr("class","g-bar");return n.append("div").attr("class","text-group").append("p").attr("class","bar-desc bar-name"),n.append("div").attr("class","bar-container bar-container__fema"),n.append("div").attr("class","bar-container bar-container__fs"),n});n.selectAll(".bar-desc").text(function(t){return t.name});var e=n.selectAll(".bar-container__fema");e.selectAll(".bar-percent").data(function(t){return[t]},function(t){return t.name}).join(function(t){return t.append("div").attr("class","bar bar-percent")}).style("width",function(t){return"".concat(o(100-t.fema),"px")}),e.selectAll(".bar-data").data(function(t){return[t]},function(t){return t.name}).join(function(t){var n=t.append("div").attr("class","bar bar-data bar-FEMA");return n.append("p"),n}).style("width",function(t){return"".concat(o(t.fema),"px")}).select("p").text(function(t){return"".concat(t.fema,"%")});var a=n.selectAll(".bar-container__fs");a.selectAll(".bar-percent").data(function(t){return[t]},function(t){return t.name}).join(function(t){return t.append("div").attr("class","bar bar-percent")}).style("width",function(t){return"".concat(o(100-t.fs),"px")}),a.selectAll(".bar-data").data(function(t){return[t]},function(t){return t.name}).join(function(t){var n=t.append("div").attr("class","bar bar-data bar-fs");return n.append("p"),n}).style("width",function(t){return"".concat(o(t.fs),"px")}).select("p").text(function(t){return"".concat(t.fs,"%")})}function p(t){return t.map(function(t){return{name:t.locationName,fema:Math.round(+t["FEMA Properties at Risk 2020 (total)"]/+t["Total Properties"]*100),fs:Math.round(+t["FS 2020 100 Year Risk (total)"]/+t["Total Properties"]*100)}})}function b(){var n=p(t[e]);f(n),i.select(".reader").text("county"===e?"".concat(n[0].name," County"):n[0].name);var a=t[e][0]["FS-FEMA Difference, 2020 (total)"];i.select(".count").text(l(a))}function m(t){e=t.attr("id"),b()}function v(){d(),b()}function _(e,a){t=a,n=e,v()}var x={init:_,resize:d,multiButtonClick:m};exports.default=x;
},{}],"OMux":[function(require,module,exports) {
d3.selection.prototype.setupSearch=function(t){var e=t.theseData,a=t.type,o=t.thisBox,n=null,c=null;function r(t){var e=o.select("input").attr("id");c=o.selectAll("#options-".concat(e)),o.select("#options-".concat(e)).selectAll("li").data(t).join(function(t){return t.append("li").attr("role","option").attr("tabindex","-1").attr("aria-selected","false").attr("id",function(t,a){return"".concat(e,"-autocomplete_").concat(a)})}).text(function(t){return"county"===a?"".concat(t.locationName,", ").concat(t.state_iso2.toUpperCase()):"".concat(t.locationName)}).attr("data-option-value",function(t){return"county"===a?"".concat(t.locationName,", ").concat(t.state_iso2.toUpperCase()):"".concat(t.locationName)}).on("click",function(t,e,a){!function(t){var e=t.attr("data-option-value");o.selectAll("li").attr("aria-selected","false"),t.attr("aria-selected","true"),s(e)}(d3.select(a[e]))})}function l(t){o.select(".result-count").text(t>1?"".concat(t," results"):"Type for more results")}function i(){c.classed("hidden",!0)}function s(t){o.select("input").property("value",t);var e=o.select("select");e.selectAll("option").property("selected",function(e){return("county"===a?"".concat(e.locationName,", ").concat(e.state_iso2.toUpperCase()):"".concat(e.locationName))===t}),e.dispatch("change"),i()}function u(t,a){var o=a.node().value;if(o.trim().length>1){var n=o.toLowerCase(),s=new RegExp("\\b".concat(n)),u=e.filter(function(t){return t.locationName.toLowerCase().match(s)}),p=u.length;r(u),c.classed("hidden",!1),l(p)}else i(),l(1)}function p(t){var e=d3.event.code;if(["Escape","ArrowUp","ArrowDown","Tab","ArrowLeft","ArrowRight","Space","Enter","ShiftLeft","ShiftRight"].includes(e)){if("ArrowDown"===e)!function(){d3.event.preventDefault();var t=o.selectAll('[role="option"]').nodes(),e=t.filter(function(t,e,a){return"true"===d3.select(a[e]).attr("aria-selected")}),a=e.length>0?d3.select(e[0].nextSibling):d3.select(t[0]);d3.select(e[0]).attr("aria-selected",!1),a.attr("aria-selected","true"),a.node().focus()}();else if("Tab"===e)i();else if("ArrowUp"===e)!function(){d3.event.preventDefault();var t=o.selectAll('[role="option"]').nodes(),e=t.filter(function(t,e,a){return"true"===d3.select(a[e]).attr("aria-selected")}),a=e.length>0?d3.select(e[0].previousSibling):d3.select(t[0]);d3.select(e[0]).attr("aria-selected",!1),a.attr("aria-selected","true"),a.node().focus()}();else if("Enter"===e||"Space"===e){var a=o.selectAll('[role="option"]').nodes().filter(function(t,e,a){return"true"===d3.select(a[e]).attr("aria-selected")});s(d3.select(a[0]).attr("data-option-value"))}}else u(0,t)}function d(){return this===d3.event.target}!function(){o.select("select").selectAll("option").data(e).join(function(t){return t.append("option")}).text(function(t){return"county"===a?"".concat(t.locationName,", ").concat(t.state_iso2.toUpperCase()):"".concat(t.locationName)}).attr("value",function(t){return"".concat(t.locationName,", ").concat(t.state_iso2.toUpperCase())});var t=o.attr("data-js");(n=o.selectAll(".autocomplete").data([e]).join(function(e){var a=e.append("div").attr("class","autocomplete");return a.append("input").attr("aria-owns","options-".concat(t)).attr("autocapitalize","none").attr("type","text").attr("autocomplete","off").attr("aria-autocomplete","list").attr("role","combobox").attr("id",t).attr("aria-expanded","false"),a.append("ul").attr("id","options-".concat(t)).attr("role","listbox").attr("class","hidden"),a.append("div").attr("aria-live","polite").attr("role","status").attr("class","visually-hidden result-count"),a})).select("input").attr("placeholder","Search for a ".concat(a)),r(e),n.on("keyup",function(t,e,a){var n;p(d3.select(a[e]).select("input")),n=o.selectAll(".autocomplete *"),d3.select("body").on("click",function(t,e,a){n.filter(d).empty()&&i()})})}()};
},{}],"qmoR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=d3.format(",");function e(e){var r=d3.sum(e.stateData,function(t){return t["FS 2020 100 Year Risk (total)"]});d3.select(".at-risk-properties").text(t(r))}var r={init:e};exports.default=r;
},{}],"bgX8":[function(require,module,exports) {
var define;
var t;!function(e,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof t&&t.amd?t([],i):"object"==typeof exports?exports.GIF=i():e.GIF=i()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var n,r,s={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};n=i(1).EventEmitter,i(2),r=function(t){function e(t){var e,n,r;for(n in this.running=!1,this.options={},this.frames=[],this.groups=new Map,this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),i)r=i[n],null==(e=this.options)[n]&&(e[n]=r)}var i,n;return function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,t),i={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1},n={delay:500,copy:!1},e.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},e.prototype.setOptions=function(t){var e,i,n;for(e in i=[],t)s.call(t,e)&&(n=t[e],i.push(this.setOption(e,n)));return i},e.prototype.addFrame=function(t,e){var i,r,s;for(s in null==e&&(e={}),(i={}).transparent=this.options.transparent,n)i[s]=e[s]||n[s];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!==ImageData&&t instanceof ImageData)i.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?i.data=this.getContextData(t):i.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?i.data=this.getImageData(t):i.image=t}return(r=this.frames.length)>0&&i.data&&(this.groups.has(i.data)?this.groups.get(i.data).push(r):this.groups.set(i.data,[r])),this.frames.push(i)},e.prototype.render=function(){var t,e,i;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,i;for(i=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)i.push(null);return i}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,i=e;0<=i?t<i:t>i;0<=i?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},e.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},e.prototype.spawnWorkers=function(){var t,e,i;return t=Math.min(this.options.workers,this.frames.length),function(){i=[];for(var n=e=this.freeWorkers.length;e<=t?n<t:n>t;e<=t?n++:n--)i.push(n);return i}.apply(this).forEach(function(t){return function(e){var i;return t.log("spawning worker "+e),(i=new Worker(t.options.workerScript)).onmessage=function(e){return t.activeWorkers.splice(t.activeWorkers.indexOf(i),1),t.freeWorkers.push(i),t.frameFinished(e.data,!1)},t.freeWorkers.push(i)}}(this)),t},e.prototype.frameFinished=function(t,e){var i,n,r,s;if(this.finishedFrames++,e?(i=this.frames.indexOf(t),n=this.groups.get(t.data)[0],this.log("frame "+(i+1)+" is duplicate of "+n+" - "+this.activeWorkers.length+" active"),this.imageParts[i]={indexOfFirstInGroup:n}):(this.log("frame "+(t.index+1)+" finished - "+this.activeWorkers.length+" active"),this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t),!0===this.options.globalPalette&&!e&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(r=1,s=this.freeWorkers.length;1<=s?r<s:r>s;1<=s?++r:--r)this.renderNextFrame();return o.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},e.prototype.finishRendering=function(){var t,e,i,n,r,s,o,a,h,l,f,p,u,d,c,g,v,m,y,_;for(r=s=0,l=(v=this.imageParts).length;s<l;r=++s)(e=v[r]).indexOfFirstInGroup&&(this.imageParts[r]=this.imageParts[e.indexOfFirstInGroup]);for(h=0,o=0,f=(m=this.imageParts).length;o<f;o++)h+=((e=m[o]).data.length-1)*e.pageSize+e.cursor;for(h+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(h/1e3)+"kb"),t=new Uint8Array(h),c=0,a=0,p=(y=this.imageParts).length;a<p;a++)for(i=d=0,u=(_=(e=y[a]).data).length;d<u;i=++d)g=_[i],t.set(g,c),c+=i===e.data.length-1?e.cursor:e.pageSize;return n=new Blob([t],{type:"image/gif"}),this.emit("finished",n,t)},e.prototype.renderNextFrame=function(){var t,e,i,n;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],(e=this.frames.indexOf(t))>0&&this.groups.has(t.data)&&this.groups.get(t.data)[0]!==e?void setTimeout(function(e){return function(){return e.frameFinished(t,!0)}}(this),0):(n=this.freeWorkers.shift(),i=this.getTask(t),this.log("starting frame "+(i.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(i))},e.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},e.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(e=this._canvas.getContext("2d")).setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},e.prototype.getTask=function(t){var e,i;if(i={index:e=this.frames.indexOf(t),last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:!0},null!=t.data)i.data=t.data;else if(null!=t.context)i.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");i.data=this.getImageData(t.image)}return i},e.prototype.log=function(t){if(this.options.debug)return console.log(t)},e}(n),t.exports=r},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,o,a,h,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(s(i=this._events[t]))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(r(i))for(a=Array.prototype.slice.call(arguments,1),o=(l=i.slice()).length,h=0;h<o;h++)l[h].apply(this,a);return!0},i.prototype.addListener=function(t,e){var o;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&((o=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var r=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,s,o,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(o=(i=this._events[t]).length,s=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(i)){for(a=o;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){s=a;break}if(s<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){var i,n,r,s,o;o=navigator.userAgent.toLowerCase(),s=navigator.platform.toLowerCase(),r="ie"===(i=o.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(n={name:"version"===i[1]?i[3]:i[1],version:r||parseFloat("opera"===i[1]&&i[4]?i[4]:i[2]),platform:{name:o.match(/ip(?:ad|od|hone)/)?"ios":(o.match(/(?:webos|android)/)||s.match(/mac|win|linux/)||["other"])[0]}})[n.name]=!0,n[n.name+parseInt(n.version,10)]=!0,n.platform[n.platform.name]=!0,t.exports=n}])});
},{}],"krr3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("gif.js.optimized"));function t(e){return e&&e.__esModule?e:{default:e}}function a(){}var i=null,o=!0,r=null,l=[2020,2035,2050],s=0,n=d3.select(".gif-wrapper"),c=null,p=null,d=null,f=!1,u=!1,y=0;function g(){var e=document.createElement("canvas"),t=e.width=1e3,a=(e.height=600,e.getContext("2d"));r=setInterval(function(){for(var o in s+=1,!f&&3==y&&3==s&&u&&(f=!0,i.render()),s>2&&(s=0,y+=1),n.select(".control-wrapper").select(".year-wrapper").selectAll("input").property("checked",function(e,t){return t==s}),l)o==s?(p.text(l[s]),d.text(l[s]),c.setLayoutProperty("fsf-"+l[s],"visibility","visible")):c.setLayoutProperty("fsf-"+l[o],"visibility","none");if(2==y&&u){var r=c.getCanvas().toDataURL("image/png"),g=l[s-1];g||(g=2050);var m=new Image;m.onload=function(){a.drawImage(m,0,0),a.beginPath(),a.fillStyle="#c8f7ff",a.fillRect(t-200,50,150,75),a.fillStyle="black",a.font="48px Arial",a.fillText(g,t-177,105);var o=e.toDataURL("image/png"),r=new Image;r.onload=function(){i.addFrame(r,{copy:!0})},r.src=o},m.src=r}},1e3)}function m(e){o?r&&clearInterval(r):o||g(),o=e}function v(t,a){var r=n.select(".play-pause-wrapper").selectAll(".button");r.on("click",function(e){r.classed("active",!1),d3.select(this).classed("active",!0);var t=d3.select(this).classed("play-button");t&&!o?m(!0):o&&!t&&m(!1)}),n.select(".control-wrapper").select(".year-wrapper").selectAll("input").on("change",function(e){var t=+d3.select(this).attr("value");for(var a in s=l.indexOf(t),l)a==s?(p.text(l[s]),d.text(l[s]),c.setLayoutProperty("fsf-"+l[s],"visibility","visible")):c.setLayoutProperty("fsf-"+l[a],"visibility","none");o&&m(!1),r.classed("active",function(e,t){return!d3.select(this).classed("play-button")})}),d3.select("#download-gif").on("click",function(){o||(m(!1),r.classed("active",function(e,t){return!!d3.select(this).classed("play-button")})),u||(d3.select(this).text("Loading..."),u=!0,y=0,(i=new e.default({workers:1,quality:10,workerScript:"assets/scripts/gif.worker.js"})).on("finished",function(e){u=!1,f=!1,d3.select("#download-gif").text("Download GIF"),window.open(URL.createObjectURL(e,{type:"image/gif"}))}))}),mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2thZWxrN3cxMDVpYTJ0bXZwenI2ZXl1ZCJ9.E0ICxBW96VVQbnQqyRTWbA",c=new mapboxgl.Map({container:"flood-gif",style:"mapbox://styles/mapbox/light-v10",center:[-73.84,40.65],minZoom:10,zoom:12,preserveDrawingBuffer:!0});var v=null;c.on("load",function(e){c.addControl(v=new MapboxGeocoder({accessToken:mapboxgl.accessToken,countries:"us",placeholder:"Find a location",zoom:12,marker:!1,flyTo:!1,mapboxgl:mapboxgl}),"top-left"),v.on("result",function(e){console.log(e.result),c.jumpTo({center:e.result.geometry.coordinates,zoom:12})}),p=d3.select("#flood-gif").append("div").attr("class","year-label").text(l[s]),d=d3.select(".gif-year-selected"),c.addSource("fsf-2020",{type:"raster",tiles:["https://api.firststreet.org/v1/tile/probability/depth/2020/100/{z}/{x}/{y}.png?key=w6e9nl3apphi9ln2mux4aazyd9gics5a"],tileSize:256}),c.addLayer({id:"fsf-2020",source:"fsf-2020",type:"raster",minzoom:10,maxzoom:18,paint:{"raster-opacity":.8}},"aeroway-line"),c.addSource("fsf-2035",{type:"raster",tiles:["https://api.firststreet.org/v1/tile/probability/depth/2035/100/{z}/{x}/{y}.png?key=w6e9nl3apphi9ln2mux4aazyd9gics5a"],tileSize:256}),c.addLayer({id:"fsf-2035",source:"fsf-2035",type:"raster",minzoom:10,maxzoom:18,paint:{"raster-opacity":.8}},"aeroway-line"),c.addSource("fsf-2050",{type:"raster",tiles:["https://api.firststreet.org/v1/tile/probability/depth/2050/100/{z}/{x}/{y}.png?key=w6e9nl3apphi9ln2mux4aazyd9gics5a"],tileSize:256}),c.addLayer({id:"fsf-2050",source:"fsf-2050",type:"raster",minzoom:10,maxzoom:18,paint:{"raster-opacity":.8}},"aeroway-line"),g()})}var x={init:v,resize:a};exports.default=x;
},{"gif.js.optimized":"bgX8"}],"AKjl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./embed-code"));function t(e){return e&&e.__esModule?e:{default:e}}function o(){}function n(t,o){var n=[-82.985,42.466];o[0]&&(n=o);var a=!1;t.select(".embed-button").on("click",function(t){var o=i.getCenter();a||(e.default.init(d3.select(this.parentNode),"https://pudding.cool/projects/flooding/visuals/embed.html?embed=true&chart=fema-compare-map&lat="+o.lat+"&lon="+o.lng),a=!0)}),mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2thZWxrN3cxMDVpYTJ0bXZwenI2ZXl1ZCJ9.E0ICxBW96VVQbnQqyRTWbA";var i=new mapboxgl.Map({container:"fema-map",style:"mapbox://styles/dock4242/ckbuxuqa00nva1imfulcebf1r",center:n,minZoom:7,maxZoom:14,zoom:10}),l={fema:"_fema","first street":"_fs"};i.on("load",function(e){d3.select(".fema__controls-container").selectAll("input").on("click",function(e){console.log("here");var t=d3.select(this).attr("value"),o=d3.select(this).property("checked"),n="none";o&&(n="visible"),i.getStyle().layers.map(function(e){e.id.indexOf(l[t])>=0&&i.setLayoutProperty(e.id,"visibility",n)})})})}var a={init:n,resize:o};exports.default=a;
},{"./embed-code":"YNPR"}],"CpNS":[function(require,module,exports) {
"use strict";function e(e){var c=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),o=new RegExp("[\\?&]".concat(c,"=([^&#]*)")).exec(window.location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}function c(e,c){var o=[window.location.protocol,"//",window.location.host,window.location.pathname].join(""),t=document.location.search,n="".concat(e,"=").concat(c),a="?".concat(n);if(t){var l=new RegExp("([?&])".concat(e,"[^&]*")),r=new RegExp("([?&])".concat(e,"=[^&;]+[&;]?"));a=null==c||""===c?(a=t.replace(r,"$1")).replace(/[&;]$/,""):null!==t.match(l)?t.replace(l,"$1".concat(n)):"".concat(t,"&").concat(n)}a="?"===a?"":a,window.history.replaceState({},"","".concat(o).concat(a))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o={get:e,set:c};exports.default=o;
},{}],"S5Ul":[function(require,module,exports) {
"use strict";function e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function t(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(o,!0).forEach(function(e){a(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r={city:"",county:" county",state:"",zipcode:"zipcode"},o={county:"countyData",zipcode:"zipData"};function n(e){return"climate"==e?[1,1.15]:"fema"==e?[1,8]:void 0}function s(e){return d3.map(e,function(e){return+e["County FIPS"]})}function i(e,a){var r=a.map(function(a){return t({},a,{distance:c(e.latitude,e.longitude,+a.Latitude,+a.Longitude)})}).filter(function(e){return!isNaN(e.distance)});return r.sort(function(e,t){return d3.descending(t.distance,e.distance)}),r}function c(e,t,a,r){function o(e){return e*Math.PI/180}var n=o(e),s=o(a),i=o(a-e),c=o(r-t),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n)*Math.cos(s)*Math.sin(c/2)*Math.sin(c/2);return 3958.756*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}function l(e,t){var a=e.select(".legend-wrapper");a.append("p").attr("class","legend-text").text("No Change or Decrease"),a.append("div").attr("class","legend-item"),a.append("p").attr("class","legend-text").text("0%");var r=e.select(".legend-wrapper").append("div").attr("class","legend-colors");a.append("p").attr("class","legend-text").text("+"+Math.round(100*(n(t)[1]-1))+"%"),r.selectAll("div").data([.1,.3,.6,.9,1]).enter().append("div").attr("class","legend-item").style("background",function(e){return d3.interpolateRdPu(e)})}function u(e,t){e.select(".map").select(".map-tooltip").style("display",t)}function p(e,t,a,r,o){var n=["get",["get","county_fips"]],s=[];for(var i in a){var c=a[i]["County FIPS"],l=b(+a[i][e],+a[i][t],r);l||(l=o.domain()[1]);var u=f(+l,o);a[i].color=u,c>0&&(n.push(c,u),s.push(c))}return n.push("#f1f1f0"),n}function d(e,t){e.select(".map").append("div").attr("class","map-tooltip")}function f(e,t){return e<1?"#aaa":d3.interpolateRdPu(t(e))}function b(e,t,a){return"climate"==a.scope?t/e:"fema"==a.scope?0==e?null:t/e:void 0}function y(e,t,a,i,c,f,y){var v,m={locationInput:e,data:t,container:a,geo:i,scope:c,variableOne:f,variableTwo:y},h=null,g=null;g=i,console.log(g);var O=t[o[g]];console.log(O),h=s(O),mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ",l(a,c);var x=new mapboxgl.Map({container:a.select(".map").node(),style:"mapbox://styles/dock4242/ckbvo6tb30c3d1il91i7mokb9",center:[0,0],minZoom:"zipcode"==g?3:1,zoom:4,bounds:[[22.10180925964056,13.596431034352321],[-21.717652931297067,-16.37959447066632]]});d(a,x);var P=n(c);d3.map(O,function(e){return+e.index}),d3.extent(O,function(e){return b(+e[f],+e[y],m)});v=d3.scaleLinear().domain(P).range([.1,1]).clamp(!0);p(f,y,O,m,v);x.on("load",function(){function e(e){t.countyData.forEach(function(e){x.setFeatureState({source:"albersusa2",sourceLayer:"albersusa",id:+e["County FIPS"]},{color:e.color,hover:!1,hasColor:!0})})}x.addSource("albersusa2",{type:"vector",url:"mapbox://lobenichou.albersusa",promoteId:"county_fips"}),x.addLayer({id:"albersusa-fill",type:"fill",source:"albersusa2","source-layer":"albersusa",paint:{"fill-color":["case",["==",["feature-state","hasColor"],!0],["feature-state","color"],"white"]},filter:["all",["==",["get","type"],"county"],["match",["get","state_abbrev"],["AK","HI","PR"],!1,!0]]},"state-points"),x.addLayer({id:"albersusa-line",type:"line",source:"albersusa2","source-layer":"albersusa",paint:{"line-width":2,"line-opacity":["case",["boolean",["feature-state","hover"],!1],1,0],"line-color":"black"},filter:["all",["==",["get","type"],"county"],["match",["get","state_abbrev"],["AK","HI","PR"],!1,!0]]},"state-points"),x.setLayoutProperty("state-points","visibility","none"),x.isSourceLoaded("albersusa2")?e():x.on("sourcedata",function t(a){"albersusa2"===a.sourceId&&a.isSourceLoaded&&(e(),x.off("sourcedata",t))});var o=null;x.on("mousemove",function(e){var t=x.queryRenderedFeatures(e.point,{layers:["albersusa-fill"]});if(t.length>0)if(Object.keys(t[0]).indexOf("id")>-1){var n=+t[0].properties.county_fips;if(h.has(+n)){if(o!=n){var s=h.get(+n);!function(e,t,a,o){var n=e.select(".map").select(".map-tooltip");n.style("left",a.x+"px").style("top",a.y+"px");var s=Math.round(1e3*(b(+t[o.variableOne],+t[o.variableTwo],o)-1))/10+"% increase in properties affected by flooding";b(+t[o.variableOne],+t[o.variableTwo],o)||"fema"!=o.scope||(s="Zero properties identified by FEMA; "+t[o.variableTwo]+" propreties identified by First Street"),Object.keys(t).indexOf("Zipcode")>-1?n.html("<p>"+t.Zipcode+" "+r[g]+"</p><p>"+s+"</p>"):n.html("<p>"+t.locationName+" "+r[g]+"</p><p>"+s+"</p>")}(a,s,e.point,m),u(a,"block"),o&&x.setFeatureState({source:"albersusa2",sourceLayer:"albersusa",id:o},{hover:!1}),o=n,x.setFeatureState({source:"albersusa2",sourceLayer:"albersusa",id:n},{hover:!0})}}else u(a,"none")}else u(a,"none");else u(a,"none")}).on("mouseout",function(e){x.setFeatureState({source:"albersusa2",sourceLayer:"albersusa2",id:o},{hover:!1}),u(a,"none")})})}var v={init:y};exports.default=v;
},{}],"epB2":[function(require,module,exports) {
"use strict";var e=g(require("lodash.debounce")),t=g(require("./utils/is-mobile")),a=g(require("./utils/link-fix")),r=g(require("./footer")),l=g(require("./createGeojson")),n=g(require("./clusterMap")),i=g(require("./load-data")),c=g(require("./propertyTable")),o=g(require("./zipMap")),u=g(require("./utils/locate")),s=g(require("./utils/find-nearest")),d=g(require("./singleBars")),f=g(require("./multiBars"));require("./utils/search");var p=g(require("./story")),y=g(require("./animatedGif")),m=g(require("./femaMap")),b=g(require("./utils/url-parameter")),h=g(require("./countyMap"));function g(e){return e&&e.__esModule?e:{default:e}}function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(a,!0).forEach(function(t){D(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function D(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function k(e,t){return O(e)||q(e,t)||j()}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function q(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],r=!0,l=!1,n=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(o){l=!0,n=o}finally{try{r||null==c.return||c.return()}finally{if(l)throw n}}return a}}function O(e){if(Array.isArray(e))return e}var A={country_code:"US",country_name:"United States",region_code:"NY",region_name:"New York",city:"New York",zip_code:"10001",time_zone:"America/New_York",latitude:40.7789,longitude:-73.9692},S={singleBars:d.default,multiBars:f.default},z=d3.select("body"),C=0,P=null,_=null,B=null;function N(){var e=z.node().offsetWidth;C!==e&&"true"!=P&&(C=e,d.default.resize())}function Y(){return new Promise(function(e,t){"true"==P||"true"==B?(console.log(_),_[0]&&(A.longitude=+_[0],A.latitude=+_[1]),console.log(A),e(A)):(0,u.default)("fd4d87f605681c0959c16d9164ab6a4a",function(a,r){a&&t(a);var l=a||"US"!==r.country_code?{latitude:A.latitude,longitude:A.longitude}:{latitude:r.latitude,longitude:r.longitude};e(l)})})}function F(e,t,a){var r=t;("all"===e?d3.selectAll(".search-container"):e.selectAll(".search-container")).each(function(e,l,n){var i=d3.select(n[l]);null===t?r=i.attr("data-selected"):(r=t,i.attr("data-selected",r));var c=a["".concat(r,"Data")].sort(function(e,t){return d3.ascending(e.locationName,t.locationName)});i.setupSearch({theseData:c,type:r,thisBox:i})})}function M(e){return S[e]}var L=null,R=" county";function x(e,t,a){mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ";var r=new MapboxGeocoder({accessToken:mapboxgl.accessToken,countries:"us",localGeocoder:function(e){for(var t=[],a=0;a<L.features.length;a++){var r=L.features[a];-1!==r.properties.title.toLowerCase().search(e.toLowerCase())&&(r.place_name=r.properties.title+R+", "+r.properties.state.toUpperCase(),r.center=r.geometry.coordinates,t.push(r))}return t},placeholder:"Find a location",zoom:7,localGeocoderOnly:!0,marker:!1}),l=e.select(".search").node(),n=r.onAdd();l.appendChild(n),r.on("result",function(e){var a=+e.result.geometry.coordinates[0],r=+e.result.geometry.coordinates[1];(0,s.default)({latitude:r,longitude:a},t).then(function(e){d.default.init(t,e),f.default.init(t,e)})})}function E(e,t,a){var r=e.attr("data-file"),l=k(e.property("value").split(","),2),n=l[0],i=l[1].trim().toLowerCase(),c=t["".concat(a,"Data")].filter(function(e){return e.locationName===n&&e.state_iso2===i}).map(function(e){return w({},e,{latitude:+e.Latitude,longitude:+e.Longitude})});(0,s.default)(c[0],t).then(function(e){return M(r).init(t,e)})}function G(){(0,a.default)(),z.classed("is-mobile",t.default.any()),window.addEventListener("resize",(0,e.default)(N,150));var r=[],u=r[0],g=r[1],v=r[2],w=r[3],D=[];P=b.default.get("embed"),B=b.default.get("albers");var j=b.default.get("lon"),q=b.default.get("lat");_=[j,q],(0,i.default)(["city6.csv","zip6.csv","county6-3.csv","state6.csv"]).then(function(e){var t=k(e,4);u=t[0],g=t[1],v=t[2],w=t[3],D={cityData:u,zipData:g,countyData:v,stateData:w}}).then(Y).then(function(e){return(0,s.default)(e,D)}).then(function(e){b.default.get("story");var t=b.default.get("map"),a=b.default.get("chart");if("true"==P&&(d3.select("main").classed("embed",!0),d3.select("body").style("height","100%"),d3.select("html").style("height","100%")),"true"==B&&(d3.select("html").style("height","100%"),d3.select("body").style("height","100%"),d3.select("main").classed("albers",!0),"fema"==t?(d3.select(".county-map").select(".chart-title").text("Percent change in # of properties in the Special Flood Hazard Area."),h.default.init(e,D,d3.select(".county-map"),"county","fema","FEMA Properties at Risk 2020 (total)","FS 2020 100 Year Risk (total)")):h.default.init(e,D,d3.select(".county-map"),"county","climate","FS 2020 100 Year Risk (total)","FS 2050 100 Year Risk (total)")),"fema-compare-map"==a&&"true"==P&&(d3.select("main").classed("fema-compare-map",!0),m.default.init(d3.select(".fema-compare-wrapper"),_)),"cluster-map"==a&&"true"==P&&(d3.select("main").classed("cluster-map",!0),n.default.init(e,D)),"property-table-embed"==a&&"true"==P){d3.select("main").classed("property-table-embed",!0);var r=d3.select(".table-wrapper").select('input[name="table-controls"]:checked').attr("value");c.default.tableButtonClick(r),d3.select(".table-wrapper").select(".controls-container").selectAll("input").on("change",function(e){console.log("changing"),c.default.tableButtonClick(d3.select(this).attr("value"))}),c.default.init(D.countyData,d3.select(".county-table"),e,"county"),c.default.init(D.cityData,d3.select(".city-table"),e,"city"),c.default.init(D.stateData,d3.select(".state-table"),e,"state")}if("fema-table"==a&&"true"==P&&(d3.select("main").classed("fema-table",!0),d.default.init(D,e),f.default.init(D,e),d3.select(".bar-wrapper").selectAll("input").on("change",function(e,t,a){var r=d3.select(a[t]);d.default.singleButtonClick(r),f.default.multiButtonClick(r);d3.select(".bar-wrapper");"state"==r.attr("id")?(L=l.default.init(D.stateData,"search"),console.log(L),R=""):(L=l.default.init(D.countyData,"search"),R=" county")}),d3.selectAll(".search-container").select("select").on("change",function(e,t,a){var r=d3.select(a[t]),l=d3.select(a[t].parentNode).attr("data-selected");E(r,D,l)}),L=l.default.init(D.countyData,"search"),x(d3.select(".bar-wrapper"),D,"countyData")),""==P){m.default.init(d3.select(".fema-compare-wrapper"),_),p.default.init(D),y.default.init(D,e),d.default.init(D,e),f.default.init(D,e),d3.select(".bar-wrapper").selectAll("input").on("change",function(e,t,a){var r=d3.select(a[t]);d.default.singleButtonClick(r),f.default.multiButtonClick(r);d3.select(".bar-wrapper");"state"==r.attr("id")?(L=l.default.init(D.stateData,"search"),console.log(L),R=""):(L=l.default.init(D.countyData,"search"),R=" county")}),d3.selectAll(".search-container").select("select").on("change",function(e,t,a){var r=d3.select(a[t]),l=d3.select(a[t].parentNode).attr("data-selected");E(r,D,l)}),L=l.default.init(D.countyData,"search"),x(d3.select(".bar-wrapper"),D,"countyData");var i=d3.select(".table-wrapper").select('input[name="table-controls"]:checked').attr("value");c.default.tableButtonClick(i),d3.select(".table-wrapper").select(".controls-container").selectAll("input").on("change",function(e){console.log("changing"),c.default.tableButtonClick(d3.select(this).attr("value"))}),c.default.init(D.countyData,d3.select(".county-table"),e,"county"),c.default.init(D.cityData,d3.select(".city-table"),e,"city"),c.default.init(D.stateData,d3.select(".state-table"),e,"state"),o.default.init(e,D,d3.select(".climate-map"),"zipcode","climate","FS 2020 100 Year Risk (total)","FS 2050 100 Year Risk (total)"),o.default.init(e,D,d3.select(".fema-map"),"zipcode","fema","FEMA Properties at Risk 2020 (total)","FS 2020 100 Year Risk (total)"),n.default.init(e,D)}}).catch(function(e){console.log(e)})}G();
},{"lodash.debounce":"or4r","./utils/is-mobile":"WEtf","./utils/link-fix":"U9xJ","./footer":"v9Q8","./createGeojson":"HxQE","./clusterMap":"qaWx","./load-data":"xZJw","./propertyTable":"ThHl","./zipMap":"b8Pa","./utils/locate":"NSOq","./utils/find-nearest":"OhWS","./singleBars":"RVwr","./multiBars":"Ch10","./utils/search":"OMux","./story":"qmoR","./animatedGif":"krr3","./femaMap":"AKjl","./utils/url-parameter":"CpNS","./countyMap":"S5Ul"}]},{},["epB2"], null)